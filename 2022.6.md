# 笔记
## 6月27日
### 常用统计函数
+ 将第一列设置为行名称
```R
# 将第一列设置为行名称
read.table(row.name = 1)
```
+ 数据类型情况统计以及数据的统计
```R
# 数据类型
skim(DATA)
# 统计分布情况
table(DATA$IMPACT)
```
+ 利用ifelse函数处理数据
```R
DATA <- ifelse(DATA$Pathogenicity == "F", 0, 1)
```
### R语言中缺失值的处理
+ 直接删除
```R
na.omit(DATA)
```
+ 均值(中位数)填补
```R
b[is.na(b)] <- mean(b,na.rm = TRUE)
DATA$b[is.na(DATA$b)] <- mean(DATA$b,na.rm = TRUE)
```
+ 前后数据填补
```R
library(zoo)
b <- na.locf(b,fromLast = F) # fromLast表示是否要从后一个填补
```
+ 随机森林填充
```R
randomForest::na.roughfix()
```



## 6月28日
+ R中的PCA(Principal Component Analysis)分析

对于二维数据，PCA是找到一个新的坐标系，使得在新坐标系中（二维到一维），信息保留最多

+ R语言：向量、矩阵、数据框和列表
```R
# 1 向量
# 向量是用于存储数值型、字符型或逻辑型数据的一维数组（单个向量中的数据类型固定）
a <- c(1,2,3,4,5,6,7)
# 通过在⽅括号中给定元素所处位置的数值，我们可以访问向量中的元素
a[1]
a[c(1,3)] 
a[1:3]

# 2 矩阵
# 矩阵是⼀个⼆维数组，只是每个元素都拥有相同的模式（数值型、字符型或逻辑型）。可通过函数matrix创建矩阵
mymatrix <- matrix(vector,nrow=number_of_rows,ncol=number_of_columns, 
+ byrow=logical_value, # 按行填充还是按列填充
dimnames=list(char_vector_rowname,char_vector_colnames)) # 向量的行名和列名
# 我们可以使⽤下标和⽅括号来选择矩阵中的⾏、列或元素。
mymatrix[1,3] # 第一行，第三列

# 3 数据框
# 由于不同的列可以包含不同模式（数值型、字符型等）的数据，数据框的概念较矩阵来说更为⼀般
mydata <- data.frame(col1,col2,col3,···)
# 其中的列向量col1, col2, col3,… 可为任何类型（如字符型、数值型或逻辑型）
# 可以用$来访问数据框中的某个特定变量
patientdata$age

# 变量类型
# 名义（类别）型：类似于外显子或者内含子位置，数据之间没有关系；
# 有序型：类似于IMPACT，各元素之间有顺序关系，但是无法明确相差多少;
# 连续型：连续型变量可以呈现为某个范围内的任意值，并同时表⽰了顺序和数量。
# 非数值型变量（类别变量和顺序变量）在R语言中称为因子
```


## 6月29日
### 群体遗传统计
+ 1 Fst：衡量群体的分化程度（越大表示群体间遗传分化越大），针对一对等位基因
+ 1.1 HI：整个群体中观察到的杂合体频率平均值
+ 1.2 Hs：亚群体中的平均杂合度
+ 1.3 Ht：复合群体中的平均杂合度
  
  Fst = （ Ht - Hs ） / Ht

  Nei（1973）定义了不用同源配子结合的相关性概念的基因差异分化系数（gene differentiation coefficient，Gst）。

+ 2 π：核苷酸多样性（越大表示核苷酸多样性越大）

  在从某一种群中取得的多个样品DNA上随机取一段序列，将在这些序列上的同一位点碱基的不同取平均值，即可得核苷酸多样性的值。

  可以利用vcftools或者对应的R包PopGenome进行计算。选定某一基因组区域，设定好窗口大小然后滑动窗口进行计算。

  LD连锁程度越高，表明两个SNO之间的相似度越高，对于π来说，SNP的多样性就降低了，所以LD曲线下降越快，π的值就越高。

+ 3 Dxy：对核苷酸多样性绝对差异的度量
+ 3.1 jx：随机从X群体中抽取一对等位基因是同一（identical）的概率
  
  Dx：随机从X群体中抽取一对基因组间的不同等位基因的比例
  
  Dx：1 - jx

+ 3.2 jy：随机从Y群体中抽取一对等位基因是同一的概率为

  Dy：随机从Y群体中抽取一对基因组间的不同等位基因的比例

  Dy：1 - jy

+ 3.3 jxy：分别从X和Y群体中各抽取一个等位基因是同一的概率为

  Dxy：分别从X和Y群体中各抽取一个基因组间的不同等位基因的比例

  Dxy：1 - jxy

